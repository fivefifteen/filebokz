!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).filebokz=t()}(this,function(){"use strict";
/*!
    filebokz v0.1.3 (https://filebokz.js.org)
    by Kodie Grantham (https://kodieg.com)
  */function x(e,r){e=e||".filebokz","string"!=typeof r&&(r="filebokz");var v=["apng","bmp","gif","x-icon","jpeg","png","svg+xml","tiff","webp"],a=["kB","MB","GB","TB","PB","EB","ZB","YB"],t=document.createElement("div"),m="draggable"in t||"ondragstart"in t&&"ondrop"in t,s="FormData"in window&&"FileReader"in window;x.count||(x.count=0),"string"==typeof e?e=document.querySelectorAll(e):e instanceof HTMLElement&&(e=[e]);for(var c=function(e,t,r){var a=e.querySelector(".error-msg"),n=e.dataset.errorDisplayDuration||3e3;e.classList.add("error");var i=e.dataset,s="";"maxFiles"===t&&(s=(s=(s=i.maxFilesErrorMsg||"A maximum of {variable} file{s} can be uploaded.").replace(/{variable}/gi,r)).replace(/{s}/gi,1<r?"s":"")),"maxFileSize"===t&&(s=(s=i.maxFileSizeErrorMsg||"File size cannot exceed {variable}.").replace(/{variable}/gi,b(r))),"maxSize"===t&&(s=(s=i.maxSizeErrorMsg||"Total combined file size cannot exceed {variable}.").replace(/{variable}/gi,b(r))),"allowedExtensions"===t&&(s=(s=i.allowedExtensionsErrorMsg||"Only the following file types are allowed: {variable}.").replace(/{variable}/gi,r)),a&&(a.innerHTML=s,r=250,Object.prototype.hasOwnProperty.call(e.dataset,"errorAnimationDuration")&&(r=e.dataset.errorAnimationDuration),setTimeout(function(){a.innerHTML=""},n+r)),setTimeout(function(){e.classList.remove("error")},n),x.triggerEvent("error",e,{errorMessage:s,errorType:t})},L=function(e,t,r,a){return Object.prototype.hasOwnProperty.call(e,t+a)?e[t+a]:Object.prototype.hasOwnProperty.call(e,t+r)?e[t+r]:void 0},b=function(e){if(Math.abs(e)<1024)return e+" B";for(var t=-1;e/=1024,++t,1024<=Math.round(10*Math.abs(e))/10&&t<a.length-1;);return+e.toFixed(1)+" "+a[t]},o=function(e,c,f){var r=f.files,t=f.originalFiles||[],a="remove"===e.filebokzAction;if(r.length){var n=!c.dataset.appendable||"false"!==c.dataset.appendable.toLowerCase(),e=f.hasAttribute("multiple")&&"false"!==f.getAttribute("multiple").toLowerCase();if(n&&e&&!a&&t.length){for(var i=Array.from(r),s=Array.from(t),o=0;o<i.length;o++){for(var l=!1,d=0;d<s.length;d++)i[o].lastModifed===s[d].lastModifed&&i[o].name===s[d].name&&i[o].size===s[d].size&&i[o].type===s[d].type&&(l=!0);l||s.push(i[o])}f.files=x.newFileList(s),r=f.files}w(r,c,f)?c.classList.add("has-files"):r=[]}r.length||a||(f.files=x.newFileList(t),r=f.files),r.length||c.classList.remove("has-files"),f.originalFiles=r,c.dataset.fileCount=r.length;a=c.querySelector(".file-count");a&&(a.innerHTML=r.length);for(var g=0,u=0;u<r.length;u++)g+=r[u].size;c.dataset.size=g;a=c.querySelector(".size");a&&(a.innerHTML=b(g));var p=c.querySelector(".files");p&&function(){var d=p.dataset,e=p.querySelectorAll(".file");if(e)for(var t=0;t<e.length;t++)p.removeChild(e[t]);r.length&&function(){for(var l=!d.draggable||"false"!==d.draggable.toLowerCase(),e=0;e<r.length;e++)!function(e,t){var r=e.type.split("/")[0],a=e.type.replace(/[/+-](\w{1})/g,function(e){return e.toUpperCase()}).replace(/[/+-]/g,""),r=r.charAt(0).toUpperCase()+r.slice(1),n=(n=L(d,"element",r,a))||d.element||"span",i=(i=L(d,"content",r,a))||d.content||"{name}",s=(s=L(d,"contentBefore",r,a))||d.contentBefore||"",o=(o=L(d,"contentAfter",r,a))||d.contentAfter||"",a=(a=L(d,"url",r,a))||(v.includes(e.type.replace("image/",""))?window.URL.createObjectURL(e):d.url||"");i=(i=(i=(i=(i=s+i+o).replace(/{name}/gi,e.name)).replace(/{type}/gi,e.type)).replace(/{size}/gi,b(e.size))).replace(/{url}/gi,a);n=document.createElement(n);n.className="file",n.innerHTML=i,m&&l&&(n.draggable="true",n.addEventListener("drag",function(e){h(e,c.id)},!1),n.addEventListener("dragstart",function(e){y(e,c.id)},!1));i=n.querySelector(".remove");i&&i.addEventListener("click",function(e){E(e,f,t)},!1),p.append(n)}(r[e],e)}()}(),r.length>t.length?x.triggerEvent("file-added",c):r.length<t.length&&x.triggerEvent("file-removed",c)},l=function(e,t,r){e.preventDefault(),e.stopPropagation(),t.classList.add("is-dragging")},h=function(e,t){e.preventDefault(),e.stopPropagation();var r,a=document.elementFromPoint(e.pageX,e.pageY);a&&(r=document.getElementById(t),(a=a.closest("[filebokz-id]"))&&a.classList.contains("js-enabled")?(a.id!==t&&(e.target.classList.add("is-transferring"),r.classList.add("is-transferring")),e.target.classList.remove("is-removing"),r.classList.remove("is-removing")):(e.target.classList.add("is-removing"),r.classList.add("is-removing"),e.target.classList.remove("is-transferring"),r.classList.remove("is-transferring")))},y=function(e,t,r){e.target.classList.add("is-dragging");var a=Array.from(e.target.parentNode.children).indexOf(e.target);e.dataTransfer.setData("fileBoxId",t),e.dataTransfer.setData("fileIndex",a)},E=function(e,t,r){e.preventDefault(),e.stopPropagation(),x.removeFiles(t,r)},w=function(e,t,r){var a=t.dataset,r=r.hasAttribute("multiple")&&"false"!==r.getAttribute("multiple").toLowerCase()?Object.prototype.hasOwnProperty.call(a,"maxFiles")?a.maxFiles:null:1,n=a.maxFileSize,i=a.maxSize,s=a.allowedExtensions?a.allowedExtensions.split(",").map(function(e){return e.replace(/^(\.)/,"")}):null,o=0;if(r&&e.length>r)return c(t,"maxFiles",r),!1;for(var l=0;l<e.length;l++){var d=(d=e[l].name.split("."))?d.pop().toLowerCase():"[none]";if(o+=e[l].size,n&&e[l].size>n)return c(t,"maxFileSize",n),!1;if(i&&i<o)return c(t,"maxSize",i),!1;if(s&&!s.includes(d))return c(t,"allowedExtensions",s.join(", ")),!1}return!0},n=0;n<e.length;n++)!function(n){var e,t=n.closest("form"),i=n.querySelector('input[type="file"]');!i||n.classList.contains("no-js")||Object.prototype.hasOwnProperty.call(n.dataset,"filebokzId")||(x.count++,n.dataset.filebokzId=x.count,n.classList.add("js-enabled"),r&&!n.classList.contains(r)&&n.classList.add(r),s&&n.classList.add("is-advanced"),m&&n.classList.add("is-draggable"),n.id||(n.id="filebokz-"+x.count),n.dataset.allowedExtensions&&!i.getAttribute("accept")&&(e=n.dataset.allowedExtensions.split(",").map(function(e){return e.replace(/^([^.])/,".$1")}),i.setAttribute("accept",e.join(","))),n.addEventListener("dragover",function(e){l(e,n)},!1),n.addEventListener("dragenter",function(e){l(e,n)},!1),n.addEventListener("dragleave",function(e){var t;t=n,(e=e).preventDefault(),e.stopPropagation(),t.classList.remove("is-dragging")},!1),n.addEventListener("drop",function(e){!function(e,t,r){e.preventDefault(),e.stopPropagation(),t.classList.remove("is-dragging");var a=e.dataTransfer.files,n=e.dataTransfer.getData("fileBoxId");if(n){var i=e.dataTransfer.getData("fileIndex"),s=document.getElementById(n),o=s.querySelector("input"),e=s.querySelector(".files").children[i];if(s.classList.remove("is-dragging"),s.classList.remove("is-removing"),s.classList.remove("is-transferring"),e.classList.remove("is-dragging"),e.classList.remove("is-removing"),e.classList.remove("is-transferring"),n===t.id)return;s=Array.from(o.files),e=s[i],n=Array.from(r.files);r.hasAttribute("multiple")&&"false"!==r.getAttribute("multiple").toLowerCase()?n.push(e):n=[e],w(n,t,r)&&(a=x.newFileList(n),s.splice(i,1),o.files=x.newFileList(s),x.triggerEvent("change",o,{filebokzAction:"remove"}))}a&&a.length&&(r.files=a,x.triggerEvent("change",r))}(e,n,i)},!1),i.addEventListener("change",function(e){o(e,n,i)},!1),i.addEventListener("focus",function(e){n.classList.add("in-focus")},!1),i.addEventListener("blur",function(e){n.classList.remove("in-focus")},!1),t&&(n.dataset.autoSubmit&&"false"!==n.dataset.autoSubmit.toLowerCase()&&i.addEventListener("change",function(e){t.submit()},!1),t.addEventListener("reset",function(e){var t,r,a;r=i,(a=(t=n).querySelector(".error"))&&(a.innerHTML=""),t.classList.remove("error"),x.triggerEvent("change",r)},!1),t.addEventListener("submit",function(e){n.classList.add("is-uploading")},!1)),o(new Event("change"),n,i))}(e[n]);return window.addEventListener("dragover",function(e){e.preventDefault()},!1),window.addEventListener("drop",function(e){!function(e){e.preventDefault(),e.stopImmediatePropagation();var t=e.dataTransfer.getData("fileBoxId");t&&(t=document.getElementById(t).querySelector("input"),e=e.dataTransfer.getData("fileIndex"),x.removeFiles(t,e))}(e)},!1),e}return x.addFiles=function(e,t){var r=Array.from(e.files);r.concat(Array.from(t)),e.files=x.newFileList(r),x.triggerEvent("change",e)},x.newFileList=function(e){var t;try{t=new DataTransfer}catch(e){t=new ClipboardEvent("")}for(var r=0;r<e.length;r++)t.items.add(e[r]);return t.files},x.removeFiles=function(e,t,r){var a=Array.from(e.files);a.splice(t||0,r||1),e.files=x.newFileList(a),x.triggerEvent("change",e,{filebokzAction:"remove"})},x.triggerEvent=function(r,a,n,e){return setTimeout(function(){var e,t=new Event(r);for(e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);a.dispatchEvent(t)},e||1)},x});
//# sourceMappingURL=filebokz.min.js.map