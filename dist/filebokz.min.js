!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).filebokz=t()}(this,function(){"use strict";
/*!
    filebokz v0.1.1 (https://github.com/kodie/filebokz)
    by Kodie Grantham (https://kodieg.com)
  */function x(e,r){e=e||".filebokz","string"!=typeof r&&(r="filebokz");var v=["apng","bmp","gif","x-icon","jpeg","png","svg+xml","tiff","webp"],a=["kB","MB","GB","TB","PB","EB","ZB","YB"],t=document.createElement("div"),m="draggable"in t||"ondragstart"in t&&"ondrop"in t,s="FormData"in window&&"FileReader"in window;x.count||(x.count=0),"string"==typeof e?e=document.querySelectorAll(e):e instanceof HTMLElement&&(e=[e]);for(var c=function(e,t,r){var a=e.querySelector(".error-msg"),i=e.dataset.errorDisplayDuration||3e3;e.classList.add("error");var n=e.dataset,s="";"maxFiles"===t&&(s=(s=(s=n.maxFilesErrorMsg||"A maximum of {variable} file{s} can be uploaded.").replace(/{variable}/gi,r)).replace(/{s}/gi,1<r?"s":"")),"maxFileSize"===t&&(s=(s=n.maxFileSizeErrorMsg||"File size cannot exceed {variable}.").replace(/{variable}/gi,h(r))),"maxSize"===t&&(s=(s=n.maxSizeErrorMsg||"Total combined file size cannot exceed {variable}.").replace(/{variable}/gi,h(r))),"allowedExtensions"===t&&(s=(s=n.allowedExtensionsErrorMsg||"Only the following file types are allowed: {variable}.").replace(/{variable}/gi,r)),a&&(a.innerHTML=s,r=250,Object.prototype.hasOwnProperty.call(e.dataset,"errorAnimationDuration")&&(r=e.dataset.errorAnimationDuration),setTimeout(function(){a.innerHTML=""},i+r)),setTimeout(function(){e.classList.remove("error")},i),x.triggerEvent("error",e,{errorMessage:s,errorType:t})},L=function(e,t,r,a){return Object.prototype.hasOwnProperty.call(e,t+a)?e[t+a]:Object.prototype.hasOwnProperty.call(e,t+r)?e[t+r]:void 0},h=function(e){if(Math.abs(e)<1024)return e+" B";for(var t=-1;e/=1024,++t,1024<=Math.round(10*Math.abs(e))/10&&t<a.length-1;);return+e.toFixed(1)+" "+a[t]},o=function(e,c,f){var r=f.files,t=f.originalFiles||[],a="remove"===e.filebokzAction;if(r.length){var i=!c.dataset.appendable||"false"!==c.dataset.appendable.toLowerCase(),e=f.hasAttribute("multiple")&&"false"!==f.getAttribute("multiple").toLowerCase();if(i&&e&&!a&&t.length){for(var n=Array.from(r),s=Array.from(t),o=0;o<n.length;o++){for(var l=!1,d=0;d<s.length;d++)n[o].lastModifed===s[d].lastModifed&&n[o].name===s[d].name&&n[o].size===s[d].size&&n[o].type===s[d].type&&(l=!0);l||s.push(n[o])}f.files=x.newFileList(s),r=f.files}w(r,c,f)?c.classList.add("has-files"):r=[]}r.length||a||(f.files=x.newFileList(t),r=f.files),r.length||c.classList.remove("has-files"),f.originalFiles=r,c.dataset.fileCount=r.length;a=c.querySelector(".file-count");a&&(a.innerHTML=r.length);for(var g=0,u=0;u<r.length;u++)g+=r[u].size;c.dataset.size=g;a=c.querySelector(".size");a&&(a.innerHTML=h(g));var p=c.querySelector(".files");p&&function(){var d=p.dataset,e=p.querySelectorAll(".file");if(e)for(var t=0;t<e.length;t++)p.removeChild(e[t]);r.length&&function(){for(var l=!d.draggable||"false"!==d.draggable.toLowerCase(),e=0;e<r.length;e++)!function(e,t){var r=e.type.split("/")[0],a=e.type.replace(/[/+-](\w{1})/g,function(e){return e.toUpperCase()}).replace(/[/+-]/g,""),r=r.charAt(0).toUpperCase()+r.slice(1),i=(i=L(d,"element",r,a))||d.element||"span",n=(n=L(d,"content",r,a))||d.content||"{name}",s=(s=L(d,"contentBefore",r,a))||d.contentBefore||"",o=(o=L(d,"contentAfter",r,a))||d.contentAfter||"",a=(a=L(d,"url",r,a))||(v.includes(e.type.replace("image/",""))?window.URL.createObjectURL(e):d.url||"");n=(n=(n=(n=(n=s+n+o).replace(/{name}/gi,e.name)).replace(/{type}/gi,e.type)).replace(/{size}/gi,h(e.size))).replace(/{url}/gi,a);i=document.createElement(i);i.className="file",i.innerHTML=n,m&&l&&(i.draggable="true",i.addEventListener("drag",function(e){b(e,c.id)},!1),i.addEventListener("dragstart",function(e){y(e,c.id)},!1));n=i.querySelector(".remove");n&&n.addEventListener("click",function(e){E(e,f,t)},!1),p.append(i)}(r[e],e)}()}(),r.length>t.length?x.triggerEvent("file-added",c):r.length<t.length&&x.triggerEvent("file-removed",c)},l=function(e,t,r){e.preventDefault(),e.stopPropagation(),t.classList.add("is-dragging")},b=function(e,t){e.preventDefault(),e.stopPropagation();var r,a=document.elementFromPoint(e.pageX,e.pageY);a&&(r=document.getElementById(t),(a=a.closest("[filebokz-id]"))&&a.classList.contains("js-enabled")?(a.id!==t&&(e.target.classList.add("is-transferring"),r.classList.add("is-transferring")),e.target.classList.remove("is-removing"),r.classList.remove("is-removing")):(e.target.classList.add("is-removing"),r.classList.add("is-removing"),e.target.classList.remove("is-transferring"),r.classList.remove("is-transferring")))},y=function(e,t,r){e.target.classList.add("is-dragging");var a=Array.from(e.target.parentNode.children).indexOf(e.target);e.dataTransfer.setData("fileBoxId",t),e.dataTransfer.setData("fileIndex",a)},E=function(e,t,r){e.preventDefault(),e.stopPropagation(),x.removeFiles(t,r)},w=function(e,t,r){var a=t.dataset,r=r.hasAttribute("multiple")&&"false"!==r.getAttribute("multiple").toLowerCase()?Object.prototype.hasOwnProperty.call(a,"maxFiles")?a.maxFiles:null:1,i=a.maxFileSize,n=a.maxSize,s=a.allowedExtensions?a.allowedExtensions.split(","):null,o=0;if(r&&e.length>r)return c(t,"maxFiles",r),!1;for(var l=0;l<e.length;l++){var d=(d=e[l].name.split("."))?d.pop().toLowerCase():"[none]";if(o+=e[l].size,i&&e[l].size>i)return c(t,"maxFileSize",i),!1;if(n&&n<o)return c(t,"maxSize",n),!1;if(s&&!s.includes(d))return c(t,"allowedExtensions",s.join(", ")),!1}return!0},i=0;i<e.length;i++)!function(i){var t=i.closest("form"),n=i.querySelector('input[type="file"]');!n||i.classList.contains("no-js")||Object.prototype.hasOwnProperty.call(i.dataset,"filebokzId")||(x.count++,i.dataset.filebokzId=x.count,i.classList.add("js-enabled"),r&&!i.classList.contains(r)&&i.classList.add(r),s&&i.classList.add("is-advanced"),m&&i.classList.add("is-draggable"),i.id||(i.id="filebokz-"+x.count),i.addEventListener("dragover",function(e){l(e,i)},!1),i.addEventListener("dragenter",function(e){l(e,i)},!1),i.addEventListener("dragleave",function(e){var t;t=i,(e=e).preventDefault(),e.stopPropagation(),t.classList.remove("is-dragging")},!1),i.addEventListener("drop",function(e){!function(e,t,r){e.preventDefault(),e.stopPropagation(),t.classList.remove("is-dragging");var a=e.dataTransfer.files,i=e.dataTransfer.getData("fileBoxId");if(i){var n=e.dataTransfer.getData("fileIndex"),s=document.getElementById(i),o=s.querySelector("input"),e=s.querySelector(".files").children[n];if(s.classList.remove("is-dragging"),s.classList.remove("is-removing"),s.classList.remove("is-transferring"),e.classList.remove("is-dragging"),e.classList.remove("is-removing"),e.classList.remove("is-transferring"),i===t.id)return;s=Array.from(o.files),e=s[n],i=Array.from(r.files);r.hasAttribute("multiple")&&"false"!==r.getAttribute("multiple").toLowerCase()?i.push(e):i=[e],w(i,t,r)&&(a=x.newFileList(i),s.splice(n,1),o.files=x.newFileList(s),x.triggerEvent("change",o,{filebokzAction:"remove"}))}a&&a.length&&(r.files=a,x.triggerEvent("change",r))}(e,i,n)},!1),n.addEventListener("change",function(e){o(e,i,n)},!1),n.addEventListener("focus",function(e){i.classList.add("in-focus")},!1),n.addEventListener("blur",function(e){i.classList.remove("in-focus")},!1),t&&(i.dataset.autoSubmit&&"false"!==i.dataset.autoSubmit.toLowerCase()&&n.addEventListener("change",function(e){t.submit()},!1),t.addEventListener("reset",function(e){var t,r,a;r=n,(a=(t=i).querySelector(".error"))&&(a.innerHTML=""),t.classList.remove("error"),x.triggerEvent("change",r)},!1),t.addEventListener("submit",function(e){i.classList.add("is-uploading")},!1)),o(new Event("change"),i,n))}(e[i]);return window.addEventListener("dragover",function(e){e.preventDefault()},!1),window.addEventListener("drop",function(e){!function(e){e.preventDefault(),e.stopImmediatePropagation();var t=e.dataTransfer.getData("fileBoxId");t&&(t=document.getElementById(t).querySelector("input"),e=e.dataTransfer.getData("fileIndex"),x.removeFiles(t,e))}(e)},!1),e}return x.addFiles=function(e,t){var r=Array.from(e.files);r.concat(Array.from(t)),e.files=x.newFileList(r),x.triggerEvent("change",e)},x.newFileList=function(e){var t;try{t=new DataTransfer}catch(e){t=new ClipboardEvent("")}for(var r=0;r<e.length;r++)t.items.add(e[r]);return t.files},x.removeFiles=function(e,t,r){var a=Array.from(e.files);a.splice(t||0,r||1),e.files=x.newFileList(a),x.triggerEvent("change",e,{filebokzAction:"remove"})},x.triggerEvent=function(r,a,i,e){return setTimeout(function(){var e,t=new Event(r);for(e in i)Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e]);a.dispatchEvent(t)},e||1)},x});
//# sourceMappingURL=filebokz.min.js.map