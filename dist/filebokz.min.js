!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).filebokz=t()}(this,function(){"use strict";
/*!
    filebokz v0.1.0 (https://github.com/kodie/filebokz)
    by Kodie Grantham (https://kodieg.com)
  */function x(e,r){e=e||".filebokz","string"!=typeof r&&(r="filebokz");var m=["apng","bmp","gif","x-icon","jpeg","png","svg+xml","tiff","webp"],i=["kB","MB","GB","TB","PB","EB","ZB","YB"],t=document.createElement("div"),v="draggable"in t||"ondragstart"in t&&"ondrop"in t,s="FormData"in window&&"FileReader"in window;x.count||(x.count=0),"string"==typeof e?e=document.querySelectorAll(e):e instanceof HTMLElement&&(e=[e]);for(var c=function(e,t,r){var i=e.querySelector(".error-msg"),n=e.dataset.errorDisplayDuration||3e3;e.classList.add("error");var a=e.dataset,s="";"maxFiles"===t&&(s=(s=(s=a.maxFilesErrorMsg||"A maximum of {letiable} file{s} can be uploaded.").replace(/{letiable}/gi,r)).replace(/{s}/gi,1<r?"s":"")),"maxFileSize"===t&&(s=(s=a.maxFileSizeErrorMsg||"File size cannot exceed {letiable}.").replace(/{letiable}/gi,h(r))),"maxSize"===t&&(s=(s=a.maxSizeErrorMsg||"Total combined file size cannot exceed {letiable}.").replace(/{letiable}/gi,h(r))),"allowedExtensions"===t&&(s=(s=a.allowedExtensionsErrorMsg||"Only the following file types are allowed: {letiable}.").replace(/{letiable}/gi,r)),i&&(i.innerHTML=s,r=250,Object.prototype.hasOwnProperty.call(e.dataset,"errorAnimationDuration")&&(r=e.dataset.errorAnimationDuration),setTimeout(function(){i.innerHTML=""},n+r)),setTimeout(function(){e.classList.remove("error")},n),x.triggerEvent("error",e,{errorMessage:s,errorType:t})},L=function(e,t,r,i){return Object.prototype.hasOwnProperty.call(e,t+i)?e[t+i]:Object.prototype.hasOwnProperty.call(e,t+r)?e[t+r]:void 0},h=function(e){if(Math.abs(e)<1024)return e+" B";for(var t=-1;e/=1024,++t,1024<=Math.round(10*Math.abs(e))/10&&t<i.length-1;);return+e.toFixed(1)+" "+i[t]},o=function(e,c,f){var r=f.files,t=f.originalFiles||[],i="remove"===e.filebokzAction;if(r.length){var n=!c.dataset.appendable||"false"!==c.dataset.appendable.toLowerCase(),e=f.hasAttribute("multiple")&&"false"!==f.getAttribute("multiple").toLowerCase();if(n&&e&&!i&&t.length){for(var a=Array.from(r),s=Array.from(t),o=0;o<a.length;o++){for(var l=!1,d=0;d<s.length;d++)a[o].lastModifed===s[d].lastModifed&&a[o].name===s[d].name&&a[o].size===s[d].size&&a[o].type===s[d].type&&(l=!0);l||s.push(a[o])}f.files=x.newFileList(s),r=f.files}w(r,c,f)?c.classList.add("has-files"):r=[]}r.length||i||(f.files=x.newFileList(t),r=f.files),r.length||c.classList.remove("has-files"),f.originalFiles=r,c.dataset.fileCount=r.length;i=c.querySelector(".file-count");i&&(i.innerHTML=r.length);for(var g=0,u=0;u<r.length;u++)g+=r[u].size;c.dataset.size=g;i=c.querySelector(".size");i&&(i.innerHTML=h(g));var p=c.querySelector(".files");p&&function(){var d=p.dataset,e=p.querySelectorAll(".file");if(e)for(var t=0;t<e.length;t++)p.removeChild(e[t]);r.length&&function(){for(var l=!d.draggable||"false"!==d.draggable.toLowerCase(),e=0;e<r.length;e++)!function(e,t){var r=e.type.split("/")[0],i=e.type.replace(/[/+-](\w{1})/g,function(e){return e.toUpperCase()}).replace(/[/+-]/g,""),r=r.charAt(0).toUpperCase()+r.slice(1),n=(n=L(d,"element",r,i))||d.element||"span",a=(a=L(d,"content",r,i))||d.content||"{name}",s=(s=L(d,"contentBefore",r,i))||d.contentBefore||"",o=(o=L(d,"contentAfter",r,i))||d.contentAfter||"",i=(i=L(d,"url",r,i))||(m.includes(e.type.replace("image/",""))?window.URL.createObjectURL(e):d.url||"");a=(a=(a=(a=(a=s+a+o).replace(/{name}/gi,e.name)).replace(/{type}/gi,e.type)).replace(/{size}/gi,h(e.size))).replace(/{url}/gi,i);n=document.createElement(n);n.className="file",n.innerHTML=a,v&&l&&(n.draggable="true",n.addEventListener("drag",function(e){b(e,c.id)},!1),n.addEventListener("dragstart",function(e){y(e,c.id)},!1));a=n.querySelector(".remove");a&&a.addEventListener("click",function(e){E(e,f,t)},!1),p.append(n)}(r[e],e)}()}(),r.length>t.length?x.triggerEvent("file-added",c):r.length<t.length&&x.triggerEvent("file-removed",c)},l=function(e,t,r){e.preventDefault(),e.stopPropagation(),t.classList.add("is-dragging")},b=function(e,t){e.preventDefault(),e.stopPropagation();var r,i=document.elementFromPoint(e.pageX,e.pageY);i&&(r=document.getElementById(t),(i=i.closest("[filebokz-id]"))&&i.classList.contains("js-enabled")?(i.id!==t&&(e.target.classList.add("is-transferring"),r.classList.add("is-transferring")),e.target.classList.remove("is-removing"),r.classList.remove("is-removing")):(e.target.classList.add("is-removing"),r.classList.add("is-removing"),e.target.classList.remove("is-transferring"),r.classList.remove("is-transferring")))},y=function(e,t,r){e.target.classList.add("is-dragging");var i=Array.from(e.target.parentNode.children).indexOf(e.target);e.dataTransfer.setData("fileBoxId",t),e.dataTransfer.setData("fileIndex",i)},E=function(e,t,r){e.preventDefault(),e.stopPropagation(),x.removeFiles(t,r)},w=function(e,t,r){var i=t.dataset,r=r.hasAttribute("multiple")&&"false"!==r.getAttribute("multiple").toLowerCase()?Object.prototype.hasOwnProperty.call(i,"maxFiles")?i.maxFiles:null:1,n=i.maxFileSize,a=i.maxSize,s=i.allowedExtensions?i.allowedExtensions.split(","):null,o=0;if(r&&e.length>r)return c(t,"maxFiles",r),!1;for(var l=0;l<e.length;l++){var d=(d=e[l].name.split("."))?d.pop().toLowerCase():"[none]";if(o+=e[l].size,n&&e[l].size>n)return c(t,"maxFileSize",n),!1;if(a&&a<o)return c(t,"maxSize",a),!1;if(s&&!s.includes(d))return c(t,"allowedExtensions",s.join(", ")),!1}return!0},n=0;n<e.length;n++)!function(n){var t=n.closest("form"),a=n.querySelector('input[type="file"]');!a||n.classList.contains("no-js")||Object.prototype.hasOwnProperty.call(n.dataset,"filebokzId")||(x.count++,n.dataset.filebokzId=x.count,n.classList.add("js-enabled"),r&&!n.classList.contains(r)&&n.classList.add(r),s&&n.classList.add("is-advanced"),v&&n.classList.add("is-draggable"),n.id||(n.id="filebokz-"+x.count),n.addEventListener("dragover",function(e){l(e,n)},!1),n.addEventListener("dragenter",function(e){l(e,n)},!1),n.addEventListener("dragleave",function(e){var t;t=n,(e=e).preventDefault(),e.stopPropagation(),t.classList.remove("is-dragging")},!1),n.addEventListener("drop",function(e){!function(e,t,r){e.preventDefault(),e.stopPropagation(),t.classList.remove("is-dragging");var i=e.dataTransfer.files,n=e.dataTransfer.getData("fileBoxId");if(n){var a=e.dataTransfer.getData("fileIndex"),s=document.getElementById(n),o=s.querySelector("input"),e=s.querySelector(".files").children[a];if(s.classList.remove("is-dragging"),s.classList.remove("is-removing"),s.classList.remove("is-transferring"),e.classList.remove("is-dragging"),e.classList.remove("is-removing"),e.classList.remove("is-transferring"),n===t.id)return;s=Array.from(o.files),e=s[a],n=Array.from(r.files);r.hasAttribute("multiple")&&"false"!==r.getAttribute("multiple").toLowerCase()?n.push(e):n=[e],w(n,t,r)&&(i=x.newFileList(n),s.splice(a,1),o.files=x.newFileList(s),x.triggerEvent("change",o,{filebokzAction:"remove"}))}i&&i.length&&(r.files=i,x.triggerEvent("change",r))}(e,n,a)},!1),a.addEventListener("change",function(e){o(e,n,a)},!1),a.addEventListener("focus",function(e){n.classList.add("in-focus")},!1),a.addEventListener("blur",function(e){n.classList.remove("in-focus")},!1),t&&(n.dataset.autoSubmit&&"false"!==n.dataset.autoSubmit.toLowerCase()&&a.addEventListener("change",function(e){t.submit()},!1),t.addEventListener("reset",function(e){var t,r,i;r=a,(i=(t=n).querySelector(".error"))&&(i.innerHTML=""),t.classList.remove("error"),x.triggerEvent("change",r)},!1),t.addEventListener("submit",function(e){n.classList.add("is-uploading")},!1)),o(new Event("change"),n,a))}(e[n]);return window.addEventListener("dragover",function(e){e.preventDefault()},!1),window.addEventListener("drop",function(e){!function(e){e.preventDefault(),e.stopImmediatePropagation();var t=e.dataTransfer.getData("fileBoxId");t&&(t=document.getElementById(t).querySelector("input"),e=e.dataTransfer.getData("fileIndex"),x.removeFiles(t,e))}(e)},!1),e}return x.addFiles=function(e,t){var r=Array.from(e.files);r.concat(Array.from(t)),e.files=x.newFileList(r),x.triggerEvent("change",e)},x.newFileList=function(e){var t;try{t=new DataTransfer}catch(e){t=new ClipboardEvent("")}for(var r=0;r<e.length;r++)t.items.add(e[r]);return t.files},x.removeFiles=function(e,t,r){var i=Array.from(e.files);i.splice(t||0,r||1),e.files=x.newFileList(i),x.triggerEvent("change",e,{filebokzAction:"remove"})},x.triggerEvent=function(r,i,n,e){return setTimeout(function(){var e,t=new Event(r);for(e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);i.dispatchEvent(t)},e||1)},x});
//# sourceMappingURL=filebokz.min.js.map